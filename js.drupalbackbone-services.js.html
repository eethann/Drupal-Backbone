<!doctype html>  <html> <head>   <title>drupalbackbone-services.js</title>   <meta charset="utf-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>        <div id="jump_to">       Jump To &hellip;        <div id="jump_wrapper">   <form id="jump_search_wrapper" name="jump_search_form">     <input id="jump_search" name="jump_search" type="text" placeholder="Search..." tabindex="1">     <a id="clear_search" href="#" title="Clear">x</a>   </form>    <div id="jump_scroller">     <div id="jump_page">                         <a class="source" href="js.drupalbackbone-services.js.html"            title="js/drupalbackbone-services.js" data-path="js/drupalbackbone-services.js">           drupalbackbone-services         </a>                         <a class="source" href="index.html"            title="js/drupalbackbone.js" data-path="js/drupalbackbone.js">           drupalbackbone         </a>                         <a class="source" href="modules.backbone_example.js.backbone_example_app.js.html"            title="modules/backbone_example/js/backbone_example_app.js" data-path="modules/backbone_example/js/backbone_example_app.js">           backbone_example_app         </a>                         <a class="source" href="tests.backbone.test.js.html"            title="tests/backbone.test.js" data-path="tests/backbone.test.js">           backbone.test         </a>            </div>   </div> </div>      </div>        <div id="scroller">       <table id="doc_page" cellpadding="0" cellspacing="0" data-path="js/drupalbackbone-services.js">         <thead>           <tr>             <th class="docs">               <h1>                 drupalbackbone-services.js               </h1>             </th>             <th class="code">             </th>           </tr>         </thead>         <tbody>                                     <tr id="section-1">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-1">&#182;</a>                 </div>                                </td>               <td class="code">                 <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span></pre></div>               </td>             </tr>                                     <tr id="section-2">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-2">&#182;</a>                 </div>                 <p>Attached to page via Drupal behaviors, for reasons
of both perperness and so we can use Drupal JS setings.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nx">Drupal</span><span class="p">.</span><span class="nx">behaviors</span><span class="p">.</span><span class="nx">backboneServices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">attach</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>               </td>             </tr>                                     <tr id="section-3">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-3">&#182;</a>                 </div>                 <h2>Drupal.Backbone.Models for Services</h2>

<p>Drupal-specific models for apps using a Services module backend. The
main difference here is the use of a longer endpoint name and the need
to nest the attribute's JSON values inside an object with a key of the
object type (for all but users).</p>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-4">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-4">&#182;</a>                 </div>                 <h3>Drupal.Backbone.Models.Node</h3>

<p>Node-specific settings for Drupal Services' node resource.</p>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Node</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">urlRoot</span><span class="o">:</span> <span class="s2">&quot;/node&quot;</span><span class="p">,</span>
        <span class="nx">idAttribute</span><span class="o">:</span> <span class="s2">&quot;nid&quot;</span><span class="p">,</span></pre></div>               </td>             </tr>                                     <tr id="section-5">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-5">&#182;</a>                 </div>                 <p>Override toJSON function to nest all attributes in a { node: ... } key
to make this work with the Services module implementation of node PUSH/PUT.</p>               </td>               <td class="code">                 <div class="highlight"><pre>        <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">node</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span>
          <span class="p">};</span>
          <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>               </td>             </tr>                                     <tr id="section-6">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-6">&#182;</a>                 </div>                 <h3>Drupal.Backbone.UserModel</h3>

<p>Model for users.</p>

<ul>
<li>TODO: Add support for login and logout methods.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">User</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">urlRoot</span><span class="o">:</span> <span class="s2">&quot;/user&quot;</span><span class="p">,</span>
        <span class="nx">idAttribute</span><span class="o">:</span> <span class="s2">&quot;uid&quot;</span>
      <span class="p">});</span>

      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Comment</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">urlRoot</span><span class="o">:</span> <span class="s2">&quot;/comment&quot;</span><span class="p">,</span>
        <span class="nx">idAttribute</span><span class="o">:</span> <span class="s2">&quot;cid&quot;</span><span class="p">,</span></pre></div>               </td>             </tr>                                     <tr id="section-7">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-7">&#182;</a>                 </div>                 <p>Override toJSON function to nest all attributes in a { comment: ... } key
to make this work with the Services module implementation of comment PUSH/PUT.</p>               </td>               <td class="code">                 <div class="highlight"><pre>        <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">comment</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span>
          <span class="p">};</span>
          <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>

      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">File</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">urlRoot</span><span class="o">:</span> <span class="s2">&quot;/file&quot;</span><span class="p">,</span>
        <span class="nx">idAttribute</span><span class="o">:</span> <span class="s2">&quot;fid&quot;</span><span class="p">,</span></pre></div>               </td>             </tr>                                     <tr id="section-8">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-8">&#182;</a>                 </div>                 <p>Override toJSON function to nest all attributes in a { file: ... } key
to make this work with the Services module implementation of file PUSH/PUT.</p>               </td>               <td class="code">                 <div class="highlight"><pre>        <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">file</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span>
          <span class="p">};</span>
          <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>               </td>             </tr>                                     <tr id="section-9">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-9">&#182;</a>                 </div>                 <p>Legacy objects.
NOTE: These object references are deprecated and could go away!</p>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">NodeModel</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Node</span><span class="p">;</span>
      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">UserModel</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">User</span><span class="p">;</span>
      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">CommentModel</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">Comment</span><span class="p">;</span>
      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">FileModel</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">File</span><span class="p">;</span></pre></div>               </td>             </tr>                                     <tr id="section-10">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-10">&#182;</a>                 </div>                 <h2>Drupal Backbone Collections</h2>

<p>Specific collections for Drupal listing types.</p>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-11">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-11">&#182;</a>                 </div>                 <h3>Drupal.Backbone.NodeIndexCollection</h3>

<p>Create collection for Node resource's index interface.</p>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">NodeIndex</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">model</span><span class="o">:</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">NodeModel</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">restEndpoint</span> <span class="o">+</span> <span class="s2">&quot;/node.json&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>               </td>             </tr>                                     <tr id="section-12">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-12">&#182;</a>                 </div>                 <h3>Drupal.Backbone.NodeViewCollection</h3>

<p>Create collection for Views resource's index interface.
Note that this is just for views that use the "Content" display
for their nodes.  Field views will need to be handled differently.</p>

<p>May be worth considering if field views are really appropriate
for backbone, since it deals with collections of model objects,
and field views do not fit that mode.</p>

<ul>
<li>TODO allow view name at initialization or fetch.</li>
<li>TODO create basic view collection, subclass node and field views.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">NodeView</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">model</span><span class="o">:</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">NodeModel</span><span class="p">,</span></pre></div>               </td>             </tr>                                     <tr id="section-13">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-13">&#182;</a>                 </div>                 <p>Name of Drupal view for this collection.</p>               </td>               <td class="code">                 <div class="highlight"><pre>        <span class="nx">viewName</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">restEndpoint</span> <span class="o">+</span> <span class="s2">&quot;/views/&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">viewName</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>               </td>             </tr>                                     <tr id="section-14">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-14">&#182;</a>                 </div>                 <h3>Drupal.Backbone.UserIndexCollection</h3>

<p>Create collection for User resource's index interface.</p>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">UserIndex</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">model</span><span class="o">:</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">restEndpoint</span> <span class="o">+</span> <span class="s2">&quot;/user.json&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>               </td>             </tr>                                     <tr id="section-15">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-15">&#182;</a>                 </div>                 <h3>Drupal.Backbone.NodeCommentsCollection</h3>

<p>Create collection of all comments on a given node.</p>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">NodeComments</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">model</span><span class="o">:</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">UserModel</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">restEndpoint</span> <span class="o">+</span> <span class="s2">&quot;/user.json&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>               </td>             </tr>                                     <tr id="section-16">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-16">&#182;</a>                 </div>                 <p>Legacy objects.
NOTE: These object references are deprecated and could go away!</p>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">NodeIndexCollection</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">NodeIndex</span><span class="p">;</span>
      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">NodeViewCollection</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">NodeView</span><span class="p">;</span>
      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">UserIndexCollection</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">UserIndex</span><span class="p">;</span>
      <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">NodeCommentsCollection</span> <span class="o">=</span> <span class="nx">Drupal</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">NodeComments</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>

</pre></div>               </td>             </tr>                    </tbody>       </table>     </div>   </div>   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>   <script src="docco-client.js"></script>        <script>       docco = window.docco || {};       docco.no_results_tpl = function(vars){         vars.msg = vars.msg || 'No results.';         return '<div class="menu-item no-results">'+vars.msg+'</div>';        };       docco.sticky_item_tpl = function(vars){         if (!vars.path || !vars.href) { return; }         return '<a class="source sticky" href="'+vars.href+'"'+             'title="'+vars.path+'" data-path="'+vars.path+'">'+             vars.path.split('/').pop().split('.').shift()+             '<span class="remove" title="Remove sticky">x</span>'+           '</a>';       };     </script>    </body> </html> 